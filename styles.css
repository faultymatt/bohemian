:root{ --bg1:#0c0f2a; --bg2:#0b2030; --fg:#e8ecff; --glass:rgba(255,255,255,.06); --glass-2:rgba(255,255,255,.12); --accent:#8fb5ff; }
*{box-sizing:border-box}
html,body{height:100%}
body{ margin:0; font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial; color:var(--fg);
  background:linear-gradient(145deg,#1a1440 0%,#0b2a3a 50%,#14224f 100%); overflow:hidden; }
body::before{content:""; position:fixed; inset:0;
  background: radial-gradient(1000px 700px at 20% 10%, rgba(70,110,200,.14), transparent 60%),
              radial-gradient(900px 500px at 80% 80%, rgba(70,200,210,.10), transparent 60%);
  pointer-events:none; mix-blend-mode:screen; filter:saturate(120%); }
.bg-tris{ position:fixed; inset:0; z-index:0; opacity:.18; }

/* Layout */
.appframe{ display:flex; height:100vh; width:100vw; overflow:hidden; }
.sidebar{ width:64px; padding:10px 8px; display:flex; flex-direction:column; gap:12px;
  background:linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.15)); border-right:1px solid rgba(255,255,255,.08); backdrop-filter: blur(6px); z-index:3; }
.tabbtn{ all:unset; display:grid; place-items:center; width:48px; height:48px; border-radius:12px; background:var(--glass); border:1px solid rgba(255,255,255,.08); cursor:pointer; }
.tabbtn img{ width:24px; height:24px; opacity:.9; }
.tabbtn.active{ outline:2px solid var(--accent); background:rgba(255,255,255,.12); }
.mainpane{ flex:1; display:flex; flex-direction:column; min-width:0; }
.topbar{ position:relative; z-index:2; display:flex; align-items:center; justify-content:center; padding:14px 16px;
  background:linear-gradient(to bottom, rgba(0,0,0,.25), rgba(0,0,0,.05)); border-bottom:1px solid rgba(255,255,255,.08); backdrop-filter:blur(6px); }
.brand{ display:flex; align-items:center; gap:10px; }
.favicon{ width:20px; height:20px; border-radius:4px; }
.topbar h1{ margin:0; letter-spacing:.12em; font-weight:700; font-size:14px; text-transform:uppercase; opacity:.9; }

.container{ position:relative; z-index:2; padding:24px; max-width:980px; margin:0 auto; }
.view{ display:block; }
.view[hidden]{ display:none; }
.card{ background:var(--glass); border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:16px; box-shadow:0 10px 30px rgba(0,0,0,.25) inset,0 8px 20px rgba(0,0,0,.1); }

.wavetables{ display:grid; grid-template-columns:repeat(2,minmax(240px,1fr)); gap:16px; }
.wt-card{ background:var(--glass); border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:16px; box-shadow:0 10px 30px rgba(0,0,0,.25) inset,0 8px 20px rgba(0,0,0,.1); }
.wt-card h2{ margin:0 0 10px; font-size:16px; opacity:.92; }
.wt-grid{ display:grid; gap:10px; }
.steppers{ display:flex; gap:10px; flex-wrap:wrap; }
.stepper{ display:flex; align-items:center; gap:6px; background:var(--glass-2); border:1px solid rgba(255,255,255,.12); padding:6px 8px; border-radius:10px; font-size:12px; }
.stepper button{ all:unset; cursor:pointer; padding:2px 6px; border:1px solid rgba(255,255,255,.15); border-radius:6px; }
.stepper output{ min-width:24px; text-align:center; font-variant-numeric:tabular-nums; }
.wt-scope{ width:100%; height:100px; background:rgba(0,0,0,.25); border-radius:10px; border:1px solid rgba(255,255,255,.08); }

.keyboard-section{ margin-top:22px; }
.topline{ display:flex; align-items:center; gap:12px; margin-bottom:10px; opacity:.9; }
#meter{ background:rgba(255,255,255,.08); border-radius:6px; border:1px solid rgba(255,255,255,.12); }
.keyboard{ position:relative; height:200px; background:var(--glass); border:1px solid rgba(255,255,255,.08); border-radius:14px; padding:12px; }
.key{ position:absolute; bottom:12px; width:38px; border-radius:8px; border:1px solid rgba(255,255,255,.12); cursor:pointer; user-select:none; display:flex; align-items:flex-end; justify-content:center; }
.key.white{ height:150px; background:rgba(255,255,255,.9); color:#111; }
.key.black{ height:95px; width:26px; background:#111; color:#fff; z-index:3; border-color:#000; box-shadow:0 6px 14px rgba(0,0,0,.5); }
.key.active{ outline:3px solid var(--accent); filter:saturate(140%); }
.key .label{ font-size:10px; opacity:.7; margin-bottom:6px; }
.hint{ margin-top:8px; opacity:.75; font-size:12px; }

#loading{ position:fixed; inset:0; display:grid; place-items:center; gap:10px; background:linear-gradient(160deg,#0e0a2a,#081a26); z-index:99; }
.spinner{ width:38px; height:38px; border-radius:50%; border:3px solid rgba(255,255,255,.15); border-top-color:#fff; animation:spin 1s linear infinite; }
@keyframes spin{ to{ transform:rotate(360deg);} }

.fx-grid,.rack{ display:grid; grid-template-columns: repeat(2, minmax(240px,1fr)); gap:16px; }
.module h3,.fx h3{ margin:0 0 10px; font-size:16px; opacity:.92; }
.wiring{ margin:.5em 0; }
.muted{ opacity:.7; font-size:12px; }

@media (max-width:700px){
  .wavetables{ grid-template-columns:1fr; }
  .keyboard{ height:180px; overflow-x:auto; }
}
